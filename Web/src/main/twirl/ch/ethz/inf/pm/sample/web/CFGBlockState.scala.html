@(result: ch.ethz.inf.pm.sample.oorepresentation.sil.AnalysisResult[_], blockIndex: Int, iter: Int)(app: ch.ethz.inf.pm.sample.web.App)
@nodeId(index: Int) = { "node-@index" }
@Base(title = "Control Flow Graph Block State")(app) {
    <div class="row-fluid">
        <div class="col-md-12">
            <ol class="breadcrumb">
                <li><a href="../../">All Methods</a></li>
                <li><a href="../"><span class="code">@result.method.name</span></a></li>
                <li class="active">Block @blockIndex</li>
            </ol>
        </div>
    </div>
    <div class="row-fluid">
        <div class="col-md-12">
            <ul class="pagination">
                @for(linkIter <- 0 to result.cfgState.trackedStatesOfBlock(blockIndex).size - 1) {
                <li class="@if(linkIter == iter) {active}"><a href="?iter=@linkIter">@linkIter</a></li>
                }
            </ul>
        </div>
    </div>
    @defining(result.cfgState.trackedStatesOfBlock(blockIndex)(iter)) { states =>
    <div class="row-fluid">
        <div class="col-md-12">
            <div class="well graph-well">
                <div class="graph control-flow-graph-block" id="graph">
                    @states.zipWithIndex.map { stateAndIndex =>
                    <a href="../@blockIndex/@stateAndIndex._2/?iter=@iter">
                        <div class="node" id=@nodeId(stateAndIndex._2)>
                            @stateAndIndex._1
                        </div>
                    </a>
                    }
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        jsPlumb.ready(function() {
            var view = new GraphView();
            view.rankDir = "TB";

            @for(stateIndex <- 0 to states.size - 2) {
                view.graph.addEdge(null, @nodeId(stateIndex), @nodeId(stateIndex + 1), {
                    label: "@result.cfgState.cfg.nodes(blockIndex)(stateIndex).toString"
                });
            }

            view.display();
        });
    </script>
    }
}