@(result: ch.ethz.inf.pm.sample.oorepresentation.sil.AnalysisResult[_])(app: ch.ethz.inf.pm.sample.web.App)
@nodeId(index: Int) = { "node-@index" }
@Base(title = "Control Flow Graph State")(app) {
    <div class="row-fluid">
        <div class="col-md-12">
            <ol class="breadcrumb">
                <li class="active">CFG for <span class="code">@result.method.name</span></li>
            </ol>
        </div>
    </div>

    @defining(result.cfgState.cfg) { cfg =>
    <div class="row-fluid">
        <div class="col-md-12">
            <div class="well graph-well">
                <div class="graph control-flow-graph" id="graph">
                @cfg.nodes.zipWithIndex.map { nodeAndIndex =>
                    <a href="/cfg/@nodeAndIndex._2">
                        <div class="node" id=@nodeId(nodeAndIndex._2)>
                        @if(nodeAndIndex._1.isEmpty) {
                            <i>empty</i>
                        } else {
                            <ul class="list-unstyled">
                                @nodeAndIndex._1.map { stmt =>
                                <li>@stmt</li>
                                }
                            </ul>
                        }
                        </div>
                    </a>
                }
                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        jsPlumb.ready(function() {
            var view = new GraphView();
            view.rankDir = "TB";

            @cfg.edges.map { edge =>
                view.graph.addEdge(null, @nodeId(edge._1), @nodeId(edge._2), {
                    label: "@edge._3.getOrElse("")"
                });
            }

            view.display();
        });
    </script>
    }
}